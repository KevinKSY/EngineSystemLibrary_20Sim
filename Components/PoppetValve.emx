<?xml version="1.0" encoding="UTF-8"?>
<Document>
 <Icons>
    <Icon size="128" bpp="32" format="png">
<![CDATA[89504e470d0a1a0a0000000d4948445200000080000000800806000000c33e61cb00000006624b474400ff00ff00ffa0bda793000000097048597300000ec400000ec401952b0e1b0000094a49444154789ced9d5f4c135b1ec77fe72e906bb6d47247ac888863d0320805da02a585d484408cffea4643a3d1359212a289d9b869b2afbb6ff5e5666f7834eec64521c6dd34c468820f2b446b1052ff146dac7f1e8c3e6822dee4c6d00557ce3edcdbbbc3d881994ee75fcff92413e9cc9973ceccef7bbee74fa723c21803855cbed1bb02147da102201c2a00c2a102201c2a00c2215e0008a1bfe95d073d41a44f03114218638cf4ae875e10ef00a4430540385400844305403854008443054038540084430540385400844305403854008443054038540084430540385400844305403854008443054038540084430540385400844305403a18e3151b00fc0b00b059b7cacaca6500700baf4b6cfbf916484b8b31869a9a9affea7d8d4a36b7dbfd4ffef594e4d0c477636363d0dddd9de390f1191818c0b76eddfa56adfcdfbc79f39bb76fdfaa95bdaa3c7dfa14ce9f3fbfccdf974b00fcd6613ab4a8b799efcd972f5f56eca36300c2585a5a6ae67f2e3a07d002b3de9b5fe25ac6df471d8070723a00807955ae0566bd37b9ea4dbb803c30ebbdc9556fda05104ed139009d06ca833a00e15001104ed174010b0b0b303939f9f9d3a74f00006fd42ac7e7f33db970e1c29643870ed9366cd8a05631aa2079166026b281bf7cf9f237f3f3f3375fbc78f17b8cf14f6a95178fc79b1042c13b77ee7cdfddddfd9d1985c0c7b4eb00994c066edfbefdf9ca952b9a049e0fc6781c00c6f9420806838617425138809e8117625621f031cd18801ff88f1f3fea1a78216242601846efaaadc0940e60e4c00b318b10f818d601b2811f1d1d357ce0850885d0d5d5650821608c617979c5f320c6730033075e085f0877efde358c10f818661690c964607272b228022f442804bfdf6f1821e8de05643219989a9a2acac00be10b211e8f7feff3f9341582a1068146083c42c8fecbbf0e8c715aab72f942b877ef9ee642e0a3d801969696e0c3870fb20a4d26939fc7c6c6746df10e87231c0804a2535353b06fdfbeb8dbed1e4e24127fd1b20eb984d0d3d3632b2991de2e2b2a2a60ddba7552cbfb6a9f6207989898f83c32320256abf53f52cf79fffefdbff50a3c42c8ded9d9190b06835c5f5f9fede0c183d0dadaca4c4f4f47bc5e6fe8fefdfbbfd3d20d00560a616666e64f1863498fb52f2c2c58fc7ebf7d6868c89a6fd98a05b0b8b88893c9e43f30c6834af3521b87c311eeeaea8a9e3e7d9ad9bc79330000b85c2e0000e8ececb4ecd8b183bb78f1a22e6e00f07f21484d8f100ab85cae9892321577017aaf1748012164efe8e888eddfbf9febededb59596967ef57c3cc0cf767aeedc39667a7a3ad2dede1e9a9d9dd5dc0de4a23456452f0087c311f6f97cd1c1c1c15f5b7daee0f3f17abd96baba3aeed2a54bbab9811c0a2e80620021646f6f6f8fedd9b387ebe9e9116df562545454c0d9b36799d9d9d988c7e309251209c3bb413e285e0832a203381c8eb0d7eb8d0e0c0c3055555500b076ab17a3adadcdb27dfb766e646424ee743a8793c9a4a1dc40952ec0ac2084ec1e8f27d6dbdbcbeddebd5b76ab17c366b3c19933679844221171bbdda1070f1e148d1be8be12582858960db7b7b7474f9e3cc96cdab40900f26ff562b8dd6e0bcbb2dce8e8a8a1dc4049ac4cef0008217b6b6b6bacafaf8f0b0402056bf562ac5fbf1e86868698442211696969093d7efcd8d46e60ea5900cbb2618fc7133d7efc3863b7db01a0f0ad5e0c97cb65d9b66d1b77f5ead5b8c3e1184ea7d3bab881dc5809ef8f291d0021646f6e6e8ef5f4f470ddddddb6d2d2d2afbee7d6029bcd06838383ccc3870f234ea733343737673a3730ccd7c152615936ec72b9a2478f1ed5bcd58bd1d2d262a9adade5ae5dbba68b1b10310b4008d99d4e672c1008707ebf5ff5be5e2e56ab154e9d3ac53c7af428d2d4d4147af2e48929dcc01463009665c32d2d2dd1fefe7e66e3c68d00a07fab17a3b9b9d9b275eb562e168b69e20645bd0e8010b2731c17f3fbfd9ccfe7b39594941836f07cac562b9c387182492693915dbb768552a99461ddc0b0eb002ccb869d4e67f4f0e1c34c6565250018b7d58bd1d4d464a9a9a9e1c6c7c7e3757575c32f5fbe2cb81b149d03645bbdd7ebe53a3a3a4cd3eac5282f2f8763c78e3173737391fafafa503a9d36941b287680424ebf58960d3736364683c1a0695bbd188d8d8d962d5bb670376edc28a81b28756b43380042c85e5f5f1ff3783c5c5b5b9be95bbd18e5e5e5d0dfdfcfa452a988c3e1083d7ffe5c7737d07d1da0aaaa2adcd0d0103d70e00093fd4d9d1e8b3a5ad2d0d060a9aeaee66edebc59103730e518002164dfb97367acb3b39373bbdd45dbeac5b0582c70e4c81126954a45eaeaea42af5ebdd2c50d745907a8aaaa0ad7d7d747f7eeddcb641f852629f87c388eb354575773131313f1dadadae1d7af5fcb76035d1f09930b42e80f00f0d777efdec1b367cf5429c3a43000f06784d07a8cf11fa59e64ba6920c6f80700f841eb7229b9a12f89221c537c174011476eac84332cea0084a3fb3a0045394adc9a3a00e1d0314011401d809237867d1e80220da5b1a20e4038740c6072e8cfc329741048c99fa2fc7938695007a0e40d1500e1d0750093a374c04e1d8070a803981cb9b192fc7e003a0b300fb40ba0e40d5d092c02a803502453565636c7ff4c07812647ae5b238456bcd53d97007e7bfdfaf5e5442221e9a73ae974ba5452e914559899995907003f4a493b3f3f5fb6b8b8b822ae48a81e84502300ec07808c8c7afc1d17e97ff3627410420199a73cc318bffff57c6af564430781844305403879fd381421b46abf813146f955471fb2d793adb7f0b39473f229c708a8e2006b0984621c140900638c845bf698994520740221466cc9f952f0f703608cd15a378e9f36d771611ef9a693522eff1842082b096aaeeb5eab4eb98ee73ab6d6bdcb17cd0681b96e8e54a1284927a75c2548ad63a1f22ed435145c006b55566a57518874ab95cbdfbfdadf6222cb55a6587728566f29f94bb9062528120042080bb7ec3139375b8f748574815c222cb4cba8750daabc23c86883232d06a46a97a156fe8a0460b440179aec20333b38141bb8890dd0a4ac9748c95f4d0cf1aa58b5d1ea86aa598e5a796bba142c3640d3325df6b3512c5beaeaa35ad790d7b7814a964185485d3cca275d3ee5ae362f97727cb5b2a4742172f22f842b68e6006bcd0a56dbaf249d9c72f3456919d9b452af536efeab61a8e701a43a4b312dc5ea0dfd3a9870a80008870a80700c3506a0680f7500c2a102201c2a00c2a102209cff0119d04b0a093896820000000049454e44ae426082]]>
   </Icon>
</Icons>
 <Model version="4.6" build="4.5.1.5561">
    <Sidops>
<![CDATA[intakeVV 528 312specifications active 'ExhVVVarLift'	specification 'ExhVV'description '<Information> <Description>    <Version>4.5</Version><IsMainModel>1</IsMainModel>    <LibraryPath>Components\PoppetValve.emx</LibraryPath>  <TimeStamp>2015-11-2 23:50:38</TimeStamp><KeepParameterValues>False</KeepParameterValues>  <AllowLibraryUpdate>True</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   power in pTFIn [3,1];   signal in CA;   signal in VONom;   signal in dVONom;   power out pTFOut [3,1];   signal out aOpenEff;   signal out Cd;   signal in areaMultiplier; end; icon bg bottom shadow 11776947  figures   line 224 209 256 209 color 0 fill 15132390;   line 224 209 224 257 color 0 fill 15132390;   line 304 211 304 255 color 0 fill 15132390;   line 272 209 304 209 color 0 fill 15132390;   line 264 224 240 240 288 240 264 224 color 0 fill 8355711;   line 256 209 256 217 240 225 232 225 232 257 224 257 color 0 fill 15132390;   line 272 209 272 217 288 225 296 225 296 257 304 257 304 209 272 209 color 0 fill 12632256;   line 256 209 224 209 224 257 232 257 232 225 240 225 256 217 256 209 color 0 fill 12632256;   line 264 225 264 193 color 0 fill 15132390;   text 'PoppetValve' 264 265 color 0 16;  terminals   pTFIn 208 232 fixed;   CA 304 184 fixed;   VONom 224 184 fixed;   dVONom 248 184 fixed;   pTFOut 320 232 fixed;   aOpenEff 320 208 fixed;   Cd 320 184 fixed;   areaMultiplier 280 184 fixed; end; implementation bg  submodels   EffortSensor1 272 319    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      power knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 265.1 313.3 278.9 327.4 color 0 fill 16777215;      text 'e' 272.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   EffortSensor2 416 319    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      pseudohydraulic knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 409.1 313.3 422.9 327.4 color 0 fill 16777215;      text 'e' 416.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   ExhVVArea 328.1 200.1			specifications active 'Exhaust'				specification 'Exhaust' description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:54:56</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 color 0 fill 15132390;   text 'VVArea' 328 200 color 0 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvExh;		 	// Valve Seat diameter	real global betaExh;   	// valve seat angle	real global wExh;      	// valve seat width	real global DpExh;    		// Valve port diameter	real global DsExh; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wExh / (sin(betaExh)*cos(betaExh)))) then			aOpen = pi*(lift)*cos(betaExh)*(DvExh - 2*wExh + lift/2*sin(betaExh*2));		else 			if (lift <= (sqrt((DpExh^2 - DsExh^2)/(4*(DvExh - wExh)) - wExh^2) + wExh*tan(betaExh))) then				aOpen = pi*(DvExh - wExh)*sqrt((lift - wExh*tan(betaExh))^2 + wExh^2);			else				aOpen = 0.25*pi*(DpExh^2 - DsExh^2);			end;		end;				L_Dv = lift/DvExh;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;				specification 'Intake'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-6-22 22:48:36</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 fill 15132390;   text 'VVArea' 328 200 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvIntake;		 	// Valve Seat diameter	real global betaIntake;   	// valve seat angle	real global wIntake;      	// valve seat width	real global DpIntake;    		// Valve port diameter	real global DsIntake; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wIntake / (sin(betaIntake)*cos(betaIntake)))) then			aOpen = pi*(lift)*cos(betaIntake)*(DvIntake - 2*wIntake + lift/2*sin(betaIntake*2));		else 			if (lift <= (sqrt((DpIntake^2 - DsIntake^2)/(4*(DvIntake - wIntake)) - wIntake^2) + wIntake*tan(betaIntake))) then				aOpen = pi*(DvIntake - wIntake)*sqrt((lift - wIntake*tan(betaIntake))^2 + wIntake^2);			else				aOpen = 0.25*pi*(DpIntake^2 - DsIntake^2);			end;		end;				L_Dv = lift/DvIntake;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;			end;   ExhVVLift1 304 120			specifications active 'Exhaust'				specification 'Exhaust' description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-11-2 23:44:24</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 104 340.1 136 color 0 fill 15132390;   text 'VVLift' 304 120 color 0 16;  terminals   lift 304 144 fixed;   CA 328 96 fixed;   CA_start_nom 280 96 fixed;   dCA_lift_nom 304 96 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox;	string global fnc_interp;	integer global ExhProfNoRow1;	integer global ExhProfNoRow2;	real global ExhVVProfUpX[ExhProfNoRow1];	real global ExhVVProfUpY[ExhProfNoRow1];	real global ExhVVProfDownX[ExhProfNoRow2];	real global ExhVVProfDownY[ExhProfNoRow2];	real global ExhLift_max;	integer global nStroke;	real global ExhCA_start_ref; //Reference start CA for start of valve lift	real global ExhdCA_lift_up;	 //Lift up time (should not be changed unless file is changed	real global ExhdCA_lift_down; //Lift down time (should not be changed unless file is changed	real global ExhdCA_lift_top_ref; //Reference duration for lift upvariables	real inarr1[2*ExhProfNoRow1+2];							//length should be 2 * no. of row of profile table + 2	real inarr2[2*ExhProfNoRow2+2];							//length should be 2 * no. of row of profile table + 2	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = ExhProfNoRow1;	inarr1[2:ExhProfNoRow1+1] = ExhVVProfUpX; 	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUpY;			inarr2[1] = ExhProfNoRow2;	inarr2[2:ExhProfNoRow2+1] = ExhVVProfDownX; 	inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDownY;			equations	CA_start = CA_start_nom*ExhCA_start_ref;	dCA_lift = dCA_lift_nom*ExhdCA_lift_top_ref;		dCA_total = ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= ExhdCA_lift_up then			inarr1[ExhProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= ExhdCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down then							CA_VV = phi - (CA_start + ExhdCA_lift_up + dCA_lift);							inarr2[ExhProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'Intake'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 763.9 96 836.1 128 fill 15132390;   text 'VVLift' 800 112 16;  terminals   lift 800 136 fixed;   CA 824 88 fixed;   CA_start_nom 776 88 fixed;   dCA_lift_nom 800 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox = 'dllTool20Sim.dll';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1;	integer global InProfNoRow2;	real global InVVProfUpX[InProfNoRow1]; 	real global InVVProfUpY[InProfNoRow1];	real global InVVProfDownX[InProfNoRow2];	real global InVVProfDownY[InProfNoRow2];	real global InLift_max = 1;	real global nstorke = 2;	real hidden global InCA_start_ref = 107; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 37.7;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 52; //Lift down time (should not be changed unless file is changed	real hidden global IndCA_lift_top_ref = 60; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = InProfNoRow1;	inarr1[2:InProfNoRow1+1] = InVVProfUpX; 	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUpY;			inarr2[1] = InProfNoRow2;	inarr2[2:InProfNoRow2+1] = InVVProfUpX; 	inarr2[InProfNoRow2+2:InProfNoRow2+1] = InVVProfUpY;			equations	CA_start = CA_start_nom*InCA_start_ref;	dCA_lift = dCA_lift_nom*IndCA_lift_top_ref;		dCA_total = IndCA_lift_up + dCA_lift + IndCA_lift_down;	phi = CA*180/pi mod (nstorke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= IndCA_lift_up then			inarr1[InProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= IndCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= IndCA_lift_up + dCA_lift + IndCA_lift_down then							CA_VV = phi - (CA_start + IndCA_lift_up + dCA_lift);							inarr2[InProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = InLift_max*lift; implementation_end;specification_end;			end;   MultiplyDivide1 352 248    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\MultiplyDivide.emx</LibraryPath>  <TimeStamp>2007-9-27 10:14:59</TimeStamp></Description>';    knot MultiplyDivide     ports      signal knot duplicatable in multiply [1];      signal knot duplicatable in divide [1];      signal knot out output [1];    end;    icon bg ellipse     figures      ellipse 344 240 360 256 color 0 fill 16777215;    end;    implementation eqequations	output = mul (collect (multiply)) ./ mul (collect (divide));     implementation_end;   plug pTFOut 504 336;   plug aOpenEff 520.1 280;   plug areaMultiplier 448 32;   plug pTFIn 200 336;   plug dVONom 304 56;   plug VONom 280.1 32;   plug CA 327.8 69.9;   plug Cd 328 264;   PowerDemux 241.5 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   output1 128 72 fixed;   input 128 80 fixed;   output2 128 88 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power in input;   power out output;  restrictions   causality constraint not_equal output input; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = output.e;	input.f = output.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   output1 128 64 fixed;   input 128 72 fixed;   output2 128 80 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power in input [3,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input; end; icon bg bottom  figures   line 240 312 240 360 color 0 width 2;   rectangle 235 320 243 352 color -1;   text '3' 244 346 color 8421504 8;  terminals   output1 240 320 fixed;   output2 240 336 fixed;   output3 240 352 fixed;   input 232 336 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e];	input.f = [output1.f; output2.f; output3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power in input [4,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 80 fixed;   output4 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e];	input.f = [output1.f; output2.f; output3.f; output4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power in input [5,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 72 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power in input [6,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   output6 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power in input [7,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 72 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power in input [8,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   output8 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power out output9;   power in input [9,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input;   causality constraint not_equal output9 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 72 fixed;   output6 128 80 fixed;   output7 128 88 fixed;   output8 128 96 fixed;   output9 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e; output9.e];implementation_end;	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f; output9.f];specification_end;			end;   PowerMux 449.5 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   input1 128 72 fixed;   output 128 80 fixed;   input2 128 88 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input;   power out output;  restrictions   causality constraint not_equal input output; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = input.e;	output.f = input.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   input1 128 64 fixed;   output 128 72 fixed;   input2 128 80 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power out output [3,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output; end; icon bg bottom  figures   line 448 312 448 360 color 0 width 2;   rectangle 443 312 451 344 color -1;   text '3' 452 338 color 8421504 8;  terminals   input1 448 320 fixed;   input2 448 336 fixed;   input3 448 352 fixed;   output 456 336 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e];	output.f = [input1.f; input2.f; input3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power out output [4,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 80 fixed;   input4 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e];	output.f = [input1.f; input2.f; input3.f; input4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power out output [5,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 72 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power out output [6,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   input6 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power out output [7,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 72 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power out output [8,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   input8 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power in input9;   power out output [9,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output;   causality constraint not_equal input9 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 72 fixed;   input6 128 80 fixed;   input7 128 88 fixed;   input8 128 96 fixed;   input9 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e; input9.e];implementation_end;	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f; input9.f];specification_end;			end;   Splitter1 352 280    description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';    knot Splitter     ports      signal knot duplicatable out output [1];      signal knot in input [1];    end;    icon bg ellipse     figures      ellipse 348.8 276.8 355.2 283.2 color -1 fill 0;      ellipse 347.7 275.7 356.3 284.3 color -1;     terminals      input 352 280 fixed;    end;    implementation eqequations    collect (output) = input;implementation_end;   Submodel2 352 359.5    description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>FlowRestriction\IdealNozzleCompGas.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-6-22 16:30:00</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate> </Description></Information>';    type Submodel     ports      signal in Aeff; "Effective area of nozzle (m2)"      pseudohydraulic in ppIn;      pseudothermalh in pTIn;      power in pFIn;      pseudohydraulic out ppOut;      pseudothermalh out pTOut;      power out pFOut;     restrictions      causality fixed in ppOut;      causality fixed in pFOut;      causality fixed in ppIn;      causality fixed in pTIn;      causality fixed in pFIn;    end;    icon bg bottom     figures      text 'R' 352 336 color 0 53 bold;      text 'IdealNozzleCompFlow' 352 376 color 0 16;     terminals      Aeff 352 304 fixed;      ppIn 320 320 fixed;      pTIn 320 336 fixed;      pFIn 320 352 fixed;      ppOut 384 320 fixed;      pTOut 384 336 fixed;      pFOut 384 352 fixed;    end;    implementation eq/* Ideal Nozzle ModelUses ideal nozzle equation for compressible flows assuming isentropic process. Flow restriction field. No states.Input   - Effective area of nozzle (Aeff)  - p,T,F in  - p,T,F outOutput  - dm, dE, dmb in  - dm, dE, dmb out*/parameters 	real global fs;	string global dll_ICE;	string global dll_fcn_idealNozzle;variables	real pIn, TIn, FIn, pOut;	real dm, dE, dmb;	real aa, d, pr;	real	inArrFlow[7];	real outArrFlow[3];equations  // start typing here 	aa = ppIn.e / ppOut.e;	if (aa > 1) then		pIn	= ppIn.e; TIn = pTIn.e; FIn = pFIn.e; d	= 1; 	pr = aa;		pOut = ppOut.e;	else		pIn	= ppOut.e; TIn=pTOut.e; FIn= pFOut.e;	d	= -1; pr	= 1.0/aa;		pOut = ppIn.e;	end;		// Calculate thermodynamic properties from (T,P,x)	inArrFlow = [1;Aeff;pIn;pOut;TIn;FIn;fs];	outArrFlow = dll(dll_ICE,dll_fcn_idealNozzle, inArrFlow);			dm = outArrFlow[1]*d;	dE = outArrFlow[2]*d;		dmb = outArrFlow[3]*d;	ppIn.dm = dm;	ppOut.dm  = dm;	pTIn.dH = dE;	pTOut.dH = dE;	pFIn.f = dmb;	pFOut.f = dmb;implementation_end;  end;  connections   areaMultiplier -> MultiplyDivide1\multiply 448 248;   CA -> ExhVVLift1\CA;   dVONom -> ExhVVLift1\dCA_lift_nom;   EffortSensor1\effort -> ExhVVArea\pIn 272 160 328 160;   EffortSensor1\p2 => Submodel2\ppIn;   EffortSensor2\effort -> ExhVVArea\pOut 416 160 352 160;   EffortSensor2\p2 => PowerMux\input1;   ExhVVArea\aEff -> MultiplyDivide1\multiply;   ExhVVArea\Cd -> Cd;   ExhVVLift1\lift -> ExhVVArea\lift;   MultiplyDivide1\output -> Splitter1\input;   PowerDemux\output1 => EffortSensor1\p1;   PowerDemux\output2 => Submodel2\pTIn;   PowerDemux\output3 => Submodel2\pFIn;   PowerMux\output => pTFOut;   pTFIn => PowerDemux\input;   Splitter1\output -> aOpenEff;   Splitter1\output -> Submodel2\Aeff;   Submodel2\pFOut => PowerMux\input3;   Submodel2\ppOut => EffortSensor2\p1;   Submodel2\pTOut => PowerMux\input2;   VONom -> ExhVVLift1\CA_start_nom;  end;  figures   text 'Global parameters      real global lift_max;     // Maximum lift of the vavle      real global nstorke;     // number of stroke      real hidden global CA_start_ref;        //Reference start CA for start of valve lift      real hidden global dCA_lift_up;	//Lift up time (should not be changed unless file is changed      real hidden global dCA_lift_down;     //Lift down time (should not be changed unless file is changed      real hidden global dCA_lift_top_ref;   //Reference duration for lift up      real global Dv;		 	// Valve Seat diameter      real global beta;   	// valve seat angle      real global w;      	// valve seat width      real global Dp;    		// Valve port diameter      real global Ds; 			// Valve stem diameter      ' 288 504 color 0 16; implementation_end;specification_end;	specification 'ExhVVVarLift' description '<Information>
 <Description>
    <Version>4.6</Version>
<IsMainModel>1</IsMainModel>
    <LibraryPath>Components\PoppetValve.emx</LibraryPath>
  <TimeStamp>2016-4-1 23:10:28</TimeStamp>
<KeepParameterValues>False</KeepParameterValues>
  <AllowLibraryUpdate>True</AllowLibraryUpdate>
  <Configuration>
   <struct>
    <member>
     <name>DocumentationMask</name>
     <value>
      <struct></struct>
     </value>
    </member>
   </struct>
  </Configuration>
 </Description>
</Information>'; type Submodel  ports   power in pTFIn [3,1];   signal in CA;   signal in VONom;   signal in dVONom;   power out pTFOut [3,1];   signal out aOpenEff;   signal out Cd;   signal in areaMultiplier; end; icon bg bottom shadow 11776947  figures   line 488 289 520 289 color 0 fill 15132390;   line 488 289 488 337 color 0 fill 15132390;   line 568 291 568 335 color 0 fill 15132390;   line 536 289 568 289 color 0 fill 15132390;   line 528 304 504 320 552 320 528 304 color 0 fill 8355711;   line 520 289 520 297 504 305 496 305 496 337 488 337 color 0 fill 15132390;   line 536 289 536 297 552 305 560 305 560 337 568 337 568 289 536 289 color 0 fill 12632256;   line 520 289 488 289 488 337 496 337 496 305 504 305 520 297 520 289 color 0 fill 12632256;   line 528 305 528 273 color 0 fill 15132390;   text 'PoppetValve' 528 345 color 0 16;  terminals   pTFIn 472 312 fixed;   CA 568 264 fixed;   VONom 488 264 fixed;   dVONom 512 264 fixed;   pTFOut 584 312 fixed;   aOpenEff 584 288 fixed;   Cd 584 264 fixed;   areaMultiplier 544 264 fixed; end; implementation bg  submodels   EffortSensor1 272 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      power knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 265.1 313.3 278.9 327.4 color 0 fill 16777215;      text 'e' 272.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   EffortSensor2 416 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      pseudohydraulic knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 409.1 313.3 422.9 327.4 color 0 fill 16777215;      text 'e' 416.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   ExhVVLift 304 120			specifications active 'ExhaustVarLift'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-11-2 23:44:24</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 763.9 96 836.1 128 fill 15132390;   text 'VVLift' 800 112 16;  terminals   lift 800 136 fixed;   CA 824 88 fixed;   CA_start_nom 776 88 fixed;   dCA_lift_nom 800 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox;	string global fnc_interp;	integer global ExhProfNoRow1;	integer global ExhProfNoRow2;	real global ExhVVProfUpX[ExhProfNoRow1];	real global ExhVVProfUpY[ExhProfNoRow1];	real global ExhVVProfDownX[ExhProfNoRow2];	real global ExhVVProfDownY[ExhProfNoRow2];	real global ExhLift_max;	integer global nStroke;	real global ExhCA_start_ref; //Reference start CA for start of valve lift	real global ExhdCA_lift_up;	 //Lift up time (should not be changed unless file is changed	real global ExhdCA_lift_down; //Lift down time (should not be changed unless file is changed	real global ExhdCA_lift_top_ref; //Reference duration for lift upvariables	real inarr1[2*ExhProfNoRow1+2];							//length should be 2 * no. of row of profile table + 2	real inarr2[2*ExhProfNoRow2+2];							//length should be 2 * no. of row of profile table + 2	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = ExhProfNoRow1;	inarr1[2:ExhProfNoRow1+1] = ExhVVProfUpX; 	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUpY;			inarr2[1] = ExhProfNoRow2;	inarr2[2:ExhProfNoRow2+1] = ExhVVProfDownX; 	inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDownY;			equations	CA_start = CA_start_nom*ExhCA_start_ref;	dCA_lift = dCA_lift_nom*ExhdCA_lift_top_ref;		dCA_total = ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= ExhdCA_lift_up then			inarr1[ExhProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= ExhdCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down then							CA_VV = phi - (CA_start + ExhdCA_lift_up + dCA_lift);							inarr2[ExhProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'ExhaustVarLift' description '<Information><Description><Version>4.5</Version><LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description><Attributes><GlobalRelations></GlobalRelations></Attributes></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 104 340.1 136 color 0 fill 15132390;   text 'VVLift' 304 120 color 0 16;  terminals   lift 304 144 fixed;   CA 328 96 fixed;   CA_start_nom 280 96 fixed;   dCA_lift_nom 304 96 fixed; end; implementation eqparameters	string dllToolbox = 'C:\Users\yum\Documents\GitHub\20SimToolBox\dll20SimToolVS10\Release\dll20SimToolVS10';	string global fnc_interp = 'interpolate';	integer global ExhProfNoRow1 = 30;	integer global ExhProfNoRow2 = 30;	real global ExhVVProfUp[ExhProfNoRow1] = [			0;			0.007;			0.021;			0.046;			0.07;			0.105;			0.161;			0.211;			0.267;			0.323;			0.372;			0.435;			0.491;			0.547;			0.604;			0.653;			0.702;			0.744;			0.782;			0.818;			0.853;			0.884;			0.909;			0.93;			0.951;			0.965;			0.979;			0.989;			0.996;			1];	real global ExhVVProfDown[ExhProfNoRow1] = [			1;			0.996;			0.993;			0.982;			0.972;			0.958;			0.937;			0.912;			0.884;			0.856;			0.821;			0.786;			0.744;			0.702;			0.656;			0.614;			0.565;			0.509;			0.442;			0.379;			0.319;			0.253;			0.196;			0.14;			0.095;			0.06;			0.032;			0.018;			0.006;			0];	real global ExhLift_max = 0.01425;	real global nStroke = 4;	real hidden global ExhCA_start_ref = 130; //Reference start CA for start of valve lift	real hidden global ExhdCA_lift_up = 123;	 //Lift up time (should not be changed unless file is changed	real hidden global ExhdCA_lift_down = 123; //Lift down time (should not be changed unless file is changed//	real hidden global IndCA_lift_top_ref = 0; //Reference duration for lift upvariables	real inarr1[ExhProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[ExhProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real CA_start_cyc;	real dCA_total_ref;	real phi;	integer i;	boolean reset;initialequations	CA_start_cyc = 720;	reset = true;	inarr1[1] = ExhProfNoRow1;	for i = 1 to ExhProfNoRow1 do		inarr1[i+1] = i / ExhProfNoRow1;	end;	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUp;			inarr2[1] = ExhProfNoRow2;	for i = 1 to ExhProfNoRow2 do		inarr2[i+1] = i / ExhProfNoRow2;	end;		inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDown;		dCA_total_ref = ExhdCA_lift_up + ExhdCA_lift_down;		equations	CA_start = CA_start_nom*ExhCA_start_ref;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and reset == true then		reset = false;		CA_start_cyc = CA_start;		dCA_total = dCA_total_ref * max([1; dCA_lift_nom]);		dCA_lift = dCA_total - dCA_total_ref;		end;	if phi > CA_start_cyc then		if phi < CA_start_cyc + dCA_total then			CA_VV = (phi - CA_start_cyc)/ExhdCA_lift_up;			if CA_VV <= 1 then				inarr1[ExhProfNoRow1*2+2] = CA_VV;				lift = dll(dllToolbox, fnc_interp, inarr1);			else 					CA_VV = (phi - CA_start_cyc)/(ExhdCA_lift_up + dCA_lift);				if CA_VV <= 1 then					lift = 1;			  	else 						CA_VV = (phi - (CA_start_cyc + ExhdCA_lift_up + dCA_lift))/ExhdCA_lift_down;					inarr2[ExhProfNoRow2*2+2] = CA_VV;					lift = dll(dllToolbox, fnc_interp,inarr2);				end;			end;		else			lift = 0;		end;	else		lift = 0;			if reset == false then			reset = true;			CA_start_cyc = 720;		end;								end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'Intake'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 96 340.1 128 color 0 fill 15132390;   text 'VVLift' 304 112 color 0 16;  terminals   lift 304 136 fixed;   CA 328 88 fixed;   CA_start_nom 280 88 fixed;   dCA_lift_nom 304 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox = 'dllTool20Sim.dll';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1;	integer global InProfNoRow2;	real global InVVProfUpX[InProfNoRow1]; 	real global InVVProfUpY[InProfNoRow1];	real global InVVProfDownX[InProfNoRow2];	real global InVVProfDownY[InProfNoRow2];	real global InLift_max = 1;	real global nstorke = 0;	real hidden global InCA_start_ref = 107; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 37.7;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 52; //Lift down time (should not be changed unless file is changed	real hidden global IndCA_lift_top_ref = 60; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = InProfNoRow1;	inarr1[2:InProfNoRow1+1] = InVVProfUpX; 	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUpY;			inarr2[1] = InProfNoRow2;	inarr2[2:InProfNoRow2+1] = InVVProfUpX; 	inarr2[InProfNoRow2+2:InProfNoRow2+1] = InVVProfUpY;			equations	CA_start = CA_start_nom*InCA_start_ref;	dCA_lift = dCA_lift_nom*IndCA_lift_top_ref;		dCA_total = IndCA_lift_up + dCA_lift + IndCA_lift_down;	phi = CA*180/pi mod (nstorke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= IndCA_lift_up then			inarr1[InProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= IndCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= IndCA_lift_up + dCA_lift + IndCA_lift_down then							CA_VV = phi - (CA_start + IndCA_lift_up + dCA_lift);							inarr2[InProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = InLift_max*lift; implementation_end;specification_end;				specification 'IntakeLiftVar' description '<Information><Description><Version>4.6</Version><LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2016-4-1 23:07:16</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description><Attributes><GlobalRelations></GlobalRelations></Attributes></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 104 340.1 136 color 0 fill 15132390;   text 'VVLift' 304 120 color 0 16;  terminals   lift 304 144 fixed;   CA 328 96 fixed;   CA_start_nom 280 96 fixed;   dCA_lift_nom 304 96 fixed; end; implementation eqparameters	string dllToolbox = 'C:\Users\yum\Documents\GitHub\20SimToolBox\dll20SimToolVS10\Release\dll20SimToolVS10';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1 = 30;	integer global InProfNoRow2 = 30;	real global InVVProfUp[InProfNoRow1] = [0;0.007;0.021;0.046;0.070;0.105;0.161;0.211;0.267;0.323;														  0.372;0.435;0.491;0.547;0.604;0.653;0.702;0.744;0.782;0.818;														  0.853;0.884;0.909;0.930;0.951;0.965;0.979;0.989;0.996;1];	real global InVVProfDown[InProfNoRow1] = [1;0.996;0.993;0.982;0.972;0.958;0.937;0.912;0.884;0.856;														0.821;0.786;0.744;0.702;0.656;0.614;0.565;0.509;0.442;0.379;														0.319;0.253;0.196;0.140;0.095;0.060;0.032;0.018;0.006;0];	real global InLift_max = 0.014;	real global nStroke = 4;	real hidden global InCA_start_ref = 343; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 121;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 121; //Lift down time (should not be changed unless file is changed//	real hidden global IndCA_lift_top_ref = 0; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real CA_start_cyc;	real dCA_total_ref;	real phi;	integer i;	boolean reset;initialequations	CA_start_cyc = 720;	reset = true;	inarr1[1] = InProfNoRow1;	for i = 1 to InProfNoRow1 do		inarr1[i+1] = i / InProfNoRow1;	end;	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUp;			inarr2[1] = InProfNoRow2;	for i = 1 to InProfNoRow2 do		inarr2[i+1] = i / InProfNoRow2;	end;		inarr2[InProfNoRow2+2:InProfNoRow2*2+1] = InVVProfDown;		dCA_total_ref = IndCA_lift_up + IndCA_lift_down;		equations	CA_start = CA_start_nom*InCA_start_ref;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and reset == true then		reset = false;		CA_start_cyc = CA_start;		dCA_total = dCA_total_ref * max([1; dCA_lift_nom]);		dCA_lift = dCA_total - dCA_total_ref;		end;	if phi > CA_start_cyc then		if phi < CA_start_cyc + dCA_total then			CA_VV = (phi - CA_start_cyc)/IndCA_lift_up;			if CA_VV <= 1 then				inarr1[InProfNoRow1*2+2] = CA_VV;				lift = dll(dllToolbox, fnc_interp, inarr1);			else 					CA_VV = (phi - CA_start_cyc)/(IndCA_lift_up + dCA_lift);				if CA_VV <= 1 then					lift = 1;			  	else 						CA_VV = (phi - (CA_start_cyc + IndCA_lift_up + dCA_lift))/IndCA_lift_down;					inarr2[InProfNoRow2*2+2] = CA_VV;					lift = dll(dllToolbox, fnc_interp,inarr2);				end;			end;		else			lift = 0;		end;	else		lift = 0;			if reset == false then			reset = true;			CA_start_cyc = 720;		end;								end;				lift = InLift_max*lift; implementation_end;specification_end;			end;   IntakeVVArea 328.1 200.1			specifications active 'Intake'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:54:56</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 fill 15132390;   text 'VVArea' 328 200 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvExh;		 	// Valve Seat diameter	real global betaExh;   	// valve seat angle	real global wExh;      	// valve seat width	real global DpExh;    		// Valve port diameter	real global DsExh; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wExh / (sin(betaExh)*cos(betaExh)))) then			aOpen = pi*(lift)*cos(betaExh)*(DvExh - 2*wExh + lift/2*sin(betaExh*2));		else 			if (lift <= (sqrt((DpExh^2 - DsExh^2)/(4*(DvExh - wExh)) - wExh^2) + wExh*tan(betaExh))) then				aOpen = pi*(DvExh - wExh)*sqrt((lift - wExh*tan(betaExh))^2 + wExh^2);			else				aOpen = 0.25*pi*(DpExh^2 - DsExh^2);			end;		end;				L_Dv = lift/DvExh;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;				specification 'Intake' description '<Information><Description><Version>4.5</Version><LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2015-6-22 22:48:36</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 color 0 fill 15132390;   text 'VVArea' 328 200 color 0 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvIntake;		 	// Valve Seat diameter	real global betaIntake;   	// valve seat angle	real global wIntake;      	// valve seat width	real global DpIntake;    		// Valve port diameter	real global DsIntake; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wIntake / (sin(betaIntake)*cos(betaIntake)))) then			aOpen = pi*(lift)*cos(betaIntake)*(DvIntake - 2*wIntake + lift/2*sin(betaIntake*2));		else 			if (lift <= (sqrt((DpIntake^2 - DsIntake^2)/(4*(DvIntake - wIntake)) - wIntake^2) + wIntake*tan(betaIntake))) then				aOpen = pi*(DvIntake - wIntake)*sqrt((lift - wIntake*tan(betaIntake))^2 + wIntake^2);			else				aOpen = 0.25*pi*(DpIntake^2 - DsIntake^2);			end;		end;				L_Dv = lift/DvIntake;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;			end;   MultiplyDivide1 352 248    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\MultiplyDivide.emx</LibraryPath>  <TimeStamp>2007-9-27 10:14:59</TimeStamp></Description>';    knot MultiplyDivide     ports      signal knot duplicatable in multiply [1];      signal knot duplicatable in divide [1];      signal knot out output [1];    end;    icon bg ellipse     figures      ellipse 344 240 360 256 color 0 fill 16777215;    end;    implementation eqequations	output = mul (collect (multiply)) ./ mul (collect (divide));     implementation_end;   plug pTFOut 504 336;   plug aOpenEff 520.1 280;   plug areaMultiplier 448 32;   plug pTFIn 200 336;   plug dVONom 304 56;   plug VONom 280.1 32;   plug CA 327.8 69.9;   plug Cd 328 264;   PowerDemux 240 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   output1 128 72 fixed;   input 128 80 fixed;   output2 128 88 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power in input;   power out output;  restrictions   causality constraint not_equal output input; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = output.e;	input.f = output.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   output1 128 64 fixed;   input 128 72 fixed;   output2 128 80 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power in input [3,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input; end; icon bg bottom  figures   line 240 312 240 360 color 0 width 2;   rectangle 235 320 243 352 color -1;   text '3' 244 346 color 8421504 8;  terminals   output1 240 320 fixed;   output2 240 336 fixed;   output3 240 352 fixed;   input 232 336 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e];	input.f = [output1.f; output2.f; output3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power in input [4,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 80 fixed;   output4 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e];	input.f = [output1.f; output2.f; output3.f; output4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power in input [5,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 72 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power in input [6,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   output6 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power in input [7,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 72 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power in input [8,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   output8 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power out output9;   power in input [9,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input;   causality constraint not_equal output9 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 72 fixed;   output6 128 80 fixed;   output7 128 88 fixed;   output8 128 96 fixed;   output9 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e; output9.e];implementation_end;	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f; output9.f];specification_end;			end;   PowerMux 448 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   input1 128 72 fixed;   output 128 80 fixed;   input2 128 88 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input;   power out output;  restrictions   causality constraint not_equal input output; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = input.e;	output.f = input.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   input1 128 64 fixed;   output 128 72 fixed;   input2 128 80 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power out output [3,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output; end; icon bg bottom  figures   line 448 312 448 360 color 0 width 2;   rectangle 443 312 451 344 color -1;   text '3' 452 338 color 8421504 8;  terminals   input1 448 320 fixed;   input2 448 336 fixed;   input3 448 352 fixed;   output 456 336 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e];	output.f = [input1.f; input2.f; input3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power out output [4,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 80 fixed;   input4 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e];	output.f = [input1.f; input2.f; input3.f; input4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power out output [5,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 72 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power out output [6,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   input6 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power out output [7,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 72 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power out output [8,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   input8 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power in input9;   power out output [9,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output;   causality constraint not_equal input9 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 72 fixed;   input6 128 80 fixed;   input7 128 88 fixed;   input8 128 96 fixed;   input9 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e; input9.e];implementation_end;	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f; input9.f];specification_end;			end;   Splitter1 352 280    description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';    knot Splitter     ports      signal knot duplicatable out output [1];      signal knot in input [1];    end;    icon bg ellipse     figures      ellipse 348.8 276.8 355.2 283.2 color -1 fill 0;      ellipse 347.7 275.7 356.3 284.3 color -1;     terminals      input 352 280 fixed;    end;    implementation eqequations    collect (output) = input;implementation_end;   Submodel2 352 351    description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>FlowRestriction\IdealNozzleCompGas.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-6-22 16:30:00</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate> </Description></Information>';    type Submodel     ports      signal in Aeff; "Effective area of nozzle (m2)"      pseudohydraulic in ppIn;      pseudothermalh in pTIn;      power in pFIn;      pseudohydraulic out ppOut;      pseudothermalh out pTOut;      power out pFOut;     restrictions      causality fixed in ppOut;      causality fixed in pFOut;      causality fixed in ppIn;      causality fixed in pTIn;      causality fixed in pFIn;    end;    icon bg bottom     figures      text 'R' 352 336 color 0 53 bold;      text 'IdealNozzle
CompFlow' 352 376 color 0 16;     terminals      Aeff 352 304 fixed;      ppIn 320 320 fixed;      pTIn 320 336 fixed;      pFIn 320 352 fixed;      ppOut 384 320 fixed;      pTOut 384 336 fixed;      pFOut 384 352 fixed;    end;    implementation eq/* Ideal Nozzle ModelUses ideal nozzle equation for compressible flows assuming isentropic process. Flow restriction field. No states.Input   - Effective area of nozzle (Aeff)  - p,T,F in  - p,T,F outOutput  - dm, dE, dmb in  - dm, dE, dmb out*/parameters 	real global fs;	string global dll_ICE;	string global dll_fcn_idealNozzle;variables	real pIn, TIn, FIn, pOut;	real dm, dE, dmb;	real aa, d, pr;	real	inArrFlow[4];	real outArrFlow[3];equations  // start typing here 	aa = ppIn.e / ppOut.e;	if (aa > 1) then		pIn	= ppIn.e; TIn = pTIn.e; FIn = pFIn.e; d	= 1; 	pr = aa;		pOut = ppOut.e;	else		pIn	= ppOut.e; TIn=pTOut.e; FIn= pFOut.e;	d	= -1; pr	= 1.0/aa;		pOut = ppIn.e;	end;		// Calculate thermodynamic properties from (T,P,x)	inArrFlow = [1,Aeff,pIn,TIn,FIn,pOut,fs];	outArrFlow = dll(dll_ICE,dll_fcn_idealNozzle, inArrFlow);			dm = outArrFlow[1]*d;	dE = outArrFlow[2]*d;		dmb = outArrFlow[3]*d;	ppIn.dm = dm;	ppOut.dm  = dm;	pTIn.dH = dE;	pTOut.dH = dE;	pFIn.f = dmb;	pFOut.f = dmb;implementation_end;  end;  connections   areaMultiplier -> MultiplyDivide1\multiply 448 248;   CA -> ExhVVLift\CA;   dVONom -> ExhVVLift\dCA_lift_nom;   EffortSensor1\effort -> IntakeVVArea\pIn 272 160 328 160;   EffortSensor1\p2 => Submodel2\ppIn;   EffortSensor2\effort -> IntakeVVArea\pOut 416 160 352 160;   EffortSensor2\p2 => PowerMux\input1;   ExhVVLift\lift -> IntakeVVArea\lift;   IntakeVVArea\aEff -> MultiplyDivide1\multiply;   IntakeVVArea\Cd -> Cd;   MultiplyDivide1\output -> Splitter1\input;   PowerDemux\output1 => EffortSensor1\p1;   PowerDemux\output2 => Submodel2\pTIn;   PowerDemux\output3 => Submodel2\pFIn;   PowerMux\output => pTFOut;   pTFIn => PowerDemux\input;   Splitter1\output -> aOpenEff;   Splitter1\output -> Submodel2\Aeff;   Submodel2\pFOut => PowerMux\input3;   Submodel2\ppOut => EffortSensor2\p1;   Submodel2\pTOut => PowerMux\input2;   VONom -> ExhVVLift\CA_start_nom;  end;  figures   text 'Global parameters
      real global lift_max;     // Maximum lift of the vavle
      real global nstorke;     // number of stroke
      real hidden global CA_start_ref;        //Reference start CA for start of valve lift
      real hidden global dCA_lift_up;	//Lift up time (should not be changed unless file is changed
      real hidden global dCA_lift_down;     //Lift down time (should not be changed unless file is changed
      real hidden global dCA_lift_top_ref;   //Reference duration for lift up
      real global Dv;		 	// Valve Seat diameter
      real global beta;   	// valve seat angle
      real global w;      	// valve seat width
      real global Dp;    		// Valve port diameter
      real global Ds; 			// Valve stem diameter
      
' 288 504 color 0 16; implementation_end;specification_end;	specification 'IntakeVV'description '<Information><Description><Version>4.5</Version><IsMainModel>1</IsMainModel><LibraryPath>Components\PoppetValve.emx</LibraryPath><TimeStamp>2015-10-20 15:58:52</TimeStamp><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description></Information>'; type Submodel  ports   power in pTFIn [3,1];   signal in CA;   signal in VONom;   signal in dVONom;   power out pTFOut [3,1];   signal out aOpenEff;   signal out Cd;   signal in areaMultiplier; end; icon bg bottom shadow 11776947  figures   line 488 289 520 289 color 0 fill 15132390;   line 488 289 488 337 color 0 fill 15132390;   line 568 291 568 335 color 0 fill 15132390;   line 536 289 568 289 color 0 fill 15132390;   line 528 304 504 320 552 320 528 304 color 0 fill 8355711;   line 520 289 520 297 504 305 496 305 496 337 488 337 color 0 fill 15132390;   line 536 289 536 297 552 305 560 305 560 337 568 337 568 289 536 289 color 0 fill 12632256;   line 520 289 488 289 488 337 496 337 496 305 504 305 520 297 520 289 color 0 fill 12632256;   line 528 305 528 273 color 0 fill 15132390;   text 'PoppetValve' 528 345 color 0 16;  terminals   pTFIn 472 312 fixed;   CA 568 264 fixed;   VONom 488 264 fixed;   dVONom 512 264 fixed;   pTFOut 584 312 fixed;   aOpenEff 584 288 fixed;   Cd 584 264 fixed;   areaMultiplier 544 264 fixed; end; implementation bg  submodels   EffortSensor1 272 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      power knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 265.1 313.3 278.9 327.4 color 0 fill 16777215;      text 'e' 272.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   EffortSensor2 416 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      pseudohydraulic knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 409.1 313.3 422.9 327.4 color 0 fill 16777215;      text 'e' 416.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   ExhVVLift1 304 112			specifications active 'Intake'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-11-2 23:44:24</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 763.9 96 836.1 128 fill 15132390;   text 'VVLift' 800 112 16;  terminals   lift 800 136 fixed;   CA 824 88 fixed;   CA_start_nom 776 88 fixed;   dCA_lift_nom 800 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox;	string global fnc_interp;	integer global ExhProfNoRow1;	integer global ExhProfNoRow2;	real global ExhVVProfUpX[ExhProfNoRow1];	real global ExhVVProfUpY[ExhProfNoRow1];	real global ExhVVProfDownX[ExhProfNoRow2];	real global ExhVVProfDownY[ExhProfNoRow2];	real global ExhLift_max;	integer global nStroke;	real global ExhCA_start_ref; //Reference start CA for start of valve lift	real global ExhdCA_lift_up;	 //Lift up time (should not be changed unless file is changed	real global ExhdCA_lift_down; //Lift down time (should not be changed unless file is changed	real global ExhdCA_lift_top_ref; //Reference duration for lift upvariables	real inarr1[2*ExhProfNoRow1+2];							//length should be 2 * no. of row of profile table + 2	real inarr2[2*ExhProfNoRow2+2];							//length should be 2 * no. of row of profile table + 2	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = ExhProfNoRow1;	inarr1[2:ExhProfNoRow1+1] = ExhVVProfUpX; 	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUpY;			inarr2[1] = ExhProfNoRow2;	inarr2[2:ExhProfNoRow2+1] = ExhVVProfDownX; 	inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDownY;			equations	CA_start = CA_start_nom*ExhCA_start_ref;	dCA_lift = dCA_lift_nom*ExhdCA_lift_top_ref;		dCA_total = ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= ExhdCA_lift_up then			inarr1[ExhProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= ExhdCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down then							CA_VV = phi - (CA_start + ExhdCA_lift_up + dCA_lift);							inarr2[ExhProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'Intake' description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 96 340.1 128 color 0 fill 15132390;   text 'VVLift' 304 112 color 0 16;  terminals   lift 304 136 fixed;   CA 328 88 fixed;   CA_start_nom 280 88 fixed;   dCA_lift_nom 304 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox = 'dllTool20Sim.dll';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1;	integer global InProfNoRow2;	real global InVVProfUpX[InProfNoRow1]; 	real global InVVProfUpY[InProfNoRow1];	real global InVVProfDownX[InProfNoRow2];	real global InVVProfDownY[InProfNoRow2];	real global InLift_max = 1;	real global nstorke = 0;	real hidden global InCA_start_ref = 107; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 37.7;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 52; //Lift down time (should not be changed unless file is changed	real hidden global IndCA_lift_top_ref = 60; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = InProfNoRow1;	inarr1[2:InProfNoRow1+1] = InVVProfUpX; 	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUpY;			inarr2[1] = InProfNoRow2;	inarr2[2:InProfNoRow2+1] = InVVProfUpX; 	inarr2[InProfNoRow2+2:InProfNoRow2+1] = InVVProfUpY;			equations	CA_start = CA_start_nom*InCA_start_ref;	dCA_lift = dCA_lift_nom*IndCA_lift_top_ref;		dCA_total = IndCA_lift_up + dCA_lift + IndCA_lift_down;	phi = CA*180/pi mod (nstorke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= IndCA_lift_up then			inarr1[InProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= IndCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= IndCA_lift_up + dCA_lift + IndCA_lift_down then							CA_VV = phi - (CA_start + IndCA_lift_up + dCA_lift);							inarr2[InProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = InLift_max*lift; implementation_end;specification_end;			end;   IntakeVVArea 328.1 200.1			specifications active 'Intake'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:54:56</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 fill 15132390;   text 'VVArea' 328 200 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvExh;		 	// Valve Seat diameter	real global betaExh;   	// valve seat angle	real global wExh;      	// valve seat width	real global DpExh;    		// Valve port diameter	real global DsExh; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wExh / (sin(betaExh)*cos(betaExh)))) then			aOpen = pi*(lift)*cos(betaExh)*(DvExh - 2*wExh + lift/2*sin(betaExh*2));		else 			if (lift <= (sqrt((DpExh^2 - DsExh^2)/(4*(DvExh - wExh)) - wExh^2) + wExh*tan(betaExh))) then				aOpen = pi*(DvExh - wExh)*sqrt((lift - wExh*tan(betaExh))^2 + wExh^2);			else				aOpen = 0.25*pi*(DpExh^2 - DsExh^2);			end;		end;				L_Dv = lift/DvExh;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;				specification 'Intake' description '<Information><Description><Version>4.5</Version><LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2015-6-22 22:48:36</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 color 0 fill 15132390;   text 'VVArea' 328 200 color 0 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvIntake;		 	// Valve Seat diameter	real global betaIntake;   	// valve seat angle	real global wIntake;      	// valve seat width	real global DpIntake;    		// Valve port diameter	real global DsIntake; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wIntake / (sin(betaIntake)*cos(betaIntake)))) then			aOpen = pi*(lift)*cos(betaIntake)*(DvIntake - 2*wIntake + lift/2*sin(betaIntake*2));		else 			if (lift <= (sqrt((DpIntake^2 - DsIntake^2)/(4*(DvIntake - wIntake)) - wIntake^2) + wIntake*tan(betaIntake))) then				aOpen = pi*(DvIntake - wIntake)*sqrt((lift - wIntake*tan(betaIntake))^2 + wIntake^2);			else				aOpen = 0.25*pi*(DpIntake^2 - DsIntake^2);			end;		end;				L_Dv = lift/DvIntake;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;			end;   MultiplyDivide1 352 248    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\MultiplyDivide.emx</LibraryPath>  <TimeStamp>2007-9-27 10:14:59</TimeStamp></Description>';    knot MultiplyDivide     ports      signal knot duplicatable in multiply [1];      signal knot duplicatable in divide [1];      signal knot out output [1];    end;    icon bg ellipse     figures      ellipse 344 240 360 256 color 0 fill 16777215;    end;    implementation eqequations	output = mul (collect (multiply)) ./ mul (collect (divide));     implementation_end;   plug pTFOut 504 336;   plug aOpenEff 520.1 280;   plug areaMultiplier 448 32;   plug pTFIn 200 336;   plug dVONom 304 56;   plug VONom 280.1 32;   plug CA 327.8 69.9;   plug Cd 328 264;   PowerDemux 240 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   output1 128 72 fixed;   input 128 80 fixed;   output2 128 88 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power in input;   power out output;  restrictions   causality constraint not_equal output input; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = output.e;	input.f = output.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   output1 128 64 fixed;   input 128 72 fixed;   output2 128 80 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power in input [3,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input; end; icon bg bottom  figures   line 240 312 240 360 color 0 width 2;   rectangle 235 320 243 352 color -1;   text '3' 244 346 color 8421504 8;  terminals   output1 240 320 fixed;   output2 240 336 fixed;   output3 240 352 fixed;   input 232 336 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e];	input.f = [output1.f; output2.f; output3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power in input [4,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 80 fixed;   output4 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e];	input.f = [output1.f; output2.f; output3.f; output4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power in input [5,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 72 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power in input [6,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   output6 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power in input [7,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 72 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power in input [8,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   output8 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power out output9;   power in input [9,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input;   causality constraint not_equal output9 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 72 fixed;   output6 128 80 fixed;   output7 128 88 fixed;   output8 128 96 fixed;   output9 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e; output9.e];implementation_end;	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f; output9.f];specification_end;			end;   PowerMux 448 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   input1 128 72 fixed;   output 128 80 fixed;   input2 128 88 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input;   power out output;  restrictions   causality constraint not_equal input output; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = input.e;	output.f = input.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   input1 128 64 fixed;   output 128 72 fixed;   input2 128 80 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power out output [3,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output; end; icon bg bottom  figures   line 448 312 448 360 color 0 width 2;   rectangle 443 312 451 344 color -1;   text '3' 452 338 color 8421504 8;  terminals   input1 448 320 fixed;   input2 448 336 fixed;   input3 448 352 fixed;   output 456 336 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e];	output.f = [input1.f; input2.f; input3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power out output [4,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 80 fixed;   input4 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e];	output.f = [input1.f; input2.f; input3.f; input4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power out output [5,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 72 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power out output [6,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   input6 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power out output [7,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 72 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power out output [8,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   input8 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power in input9;   power out output [9,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output;   causality constraint not_equal input9 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 72 fixed;   input6 128 80 fixed;   input7 128 88 fixed;   input8 128 96 fixed;   input9 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e; input9.e];implementation_end;	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f; input9.f];specification_end;			end;   Splitter1 352 280    description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';    knot Splitter     ports      signal knot duplicatable out output [1];      signal knot in input [1];    end;    icon bg ellipse     figures      ellipse 348.8 276.8 355.2 283.2 color -1 fill 0;      ellipse 347.7 275.7 356.3 284.3 color -1;     terminals      input 352 280 fixed;    end;    implementation eqequations    collect (output) = input;implementation_end;   Submodel2 352 351    description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>FlowRestriction\IdealNozzleCompGas.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-6-22 16:30:00</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate> </Description></Information>';    type Submodel     ports      signal in Aeff; "Effective area of nozzle (m2)"      pseudohydraulic in ppIn;      pseudothermalh in pTIn;      power in pFIn;      pseudohydraulic out ppOut;      pseudothermalh out pTOut;      power out pFOut;     restrictions      causality fixed in ppOut;      causality fixed in pFOut;      causality fixed in ppIn;      causality fixed in pTIn;      causality fixed in pFIn;    end;    icon bg bottom     figures      text 'R' 352 336 color 0 53 bold;      text 'IdealNozzle
CompFlow' 352 376 color 0 16;     terminals      Aeff 352 304 fixed;      ppIn 320 320 fixed;      pTIn 320 336 fixed;      pFIn 320 352 fixed;      ppOut 384 320 fixed;      pTOut 384 336 fixed;      pFOut 384 352 fixed;    end;    implementation eq/* Ideal Nozzle ModelUses ideal nozzle equation for compressible flows assuming isentropic process. Flow restriction field. No states.Input   - Effective area of nozzle (Aeff)  - p,T,F in  - p,T,F outOutput  - dm, dE, dmb in  - dm, dE, dmb out*/parameters 	real global fs;	string global dll_ICE;	string global dll_fcn_idealNozzle;variables	real pIn, TIn, FIn, pOut;	real dm, dE, dmb;	real aa, d, pr;	real	inArrFlow[4];	real outArrFlow[3];equations  // start typing here 	aa = ppIn.e / ppOut.e;	if (aa > 1) then		pIn	= ppIn.e; TIn = pTIn.e; FIn = pFIn.e; d	= 1; 	pr = aa;		pOut = ppOut.e;	else		pIn	= ppOut.e; TIn=pTOut.e; FIn= pFOut.e;	d	= -1; pr	= 1.0/aa;		pOut = ppIn.e;	end;		// Calculate thermodynamic properties from (T,P,x)	inArrFlow = [1,Aeff,pIn,TIn,FIn,pOut,fs];	outArrFlow = dll(dll_ICE,dll_fcn_idealNozzle, inArrFlow);			dm = outArrFlow[1]*d;	dE = outArrFlow[2]*d;		dmb = outArrFlow[3]*d;	ppIn.dm = dm;	ppOut.dm  = dm;	pTIn.dH = dE;	pTOut.dH = dE;	pFIn.f = dmb;	pFOut.f = dmb;implementation_end;  end;  connections   areaMultiplier -> MultiplyDivide1\multiply 448 248;   CA -> ExhVVLift1\CA;   dVONom -> ExhVVLift1\dCA_lift_nom;   EffortSensor1\effort -> IntakeVVArea\pIn 272 160 328 160;   EffortSensor1\p2 => Submodel2\ppIn;   EffortSensor2\effort -> IntakeVVArea\pOut 416 160 352 160;   EffortSensor2\p2 => PowerMux\input1;   ExhVVLift1\lift -> IntakeVVArea\lift;   IntakeVVArea\aEff -> MultiplyDivide1\multiply;   IntakeVVArea\Cd -> Cd;   MultiplyDivide1\output -> Splitter1\input;   PowerDemux\output1 => EffortSensor1\p1;   PowerDemux\output2 => Submodel2\pTIn;   PowerDemux\output3 => Submodel2\pFIn;   PowerMux\output => pTFOut;   pTFIn => PowerDemux\input;   Splitter1\output -> aOpenEff;   Splitter1\output -> Submodel2\Aeff;   Submodel2\pFOut => PowerMux\input3;   Submodel2\ppOut => EffortSensor2\p1;   Submodel2\pTOut => PowerMux\input2;   VONom -> ExhVVLift1\CA_start_nom;  end;  figures   text 'Global parameters
      real global lift_max;     // Maximum lift of the vavle
      real global nstorke;     // number of stroke
      real hidden global CA_start_ref;        //Reference start CA for start of valve lift
      real hidden global dCA_lift_up;	//Lift up time (should not be changed unless file is changed
      real hidden global dCA_lift_down;     //Lift down time (should not be changed unless file is changed
      real hidden global dCA_lift_top_ref;   //Reference duration for lift up
      real global Dv;		 	// Valve Seat diameter
      real global beta;   	// valve seat angle
      real global w;      	// valve seat width
      real global Dp;    		// Valve port diameter
      real global Ds; 			// Valve stem diameter
      
' 288 504 color 0 16; implementation_end;specification_end;	specification 'IntakeVVVarLift' description '<Information><Description><Version>4.5</Version><IsMainModel>1</IsMainModel><LibraryPath>Components\PoppetValve.emx</LibraryPath><TimeStamp>2015-10-20 15:58:52</TimeStamp><KeepParameterValues>False</KeepParameterValues><AllowLibraryUpdate>True</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description></Information>'; type Submodel  ports   power in pTFIn [3,1];   signal in CA;   signal in VONom;   signal in dVONom;   power out pTFOut [3,1];   signal out aOpenEff;   signal out Cd;   signal in areaMultiplier; end; icon bg bottom shadow 11776947  figures   line 488 289 520 289 color 0 fill 15132390;   line 488 289 488 337 color 0 fill 15132390;   line 568 291 568 335 color 0 fill 15132390;   line 536 289 568 289 color 0 fill 15132390;   line 528 304 504 320 552 320 528 304 color 0 fill 8355711;   line 520 289 520 297 504 305 496 305 496 337 488 337 color 0 fill 15132390;   line 536 289 536 297 552 305 560 305 560 337 568 337 568 289 536 289 color 0 fill 12632256;   line 520 289 488 289 488 337 496 337 496 305 504 305 520 297 520 289 color 0 fill 12632256;   line 528 305 528 273 color 0 fill 15132390;   text 'PoppetValve' 528 345 color 0 16;  terminals   pTFIn 472 312 fixed;   CA 568 264 fixed;   VONom 488 264 fixed;   dVONom 512 264 fixed;   pTFOut 584 312 fixed;   aOpenEff 584 288 fixed;   Cd 584 264 fixed;   areaMultiplier 544 264 fixed; end; implementation bg  submodels   EffortSensor1 272 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      power knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 265.1 313.3 278.9 327.4 color 0 fill 16777215;      text 'e' 272.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   EffortSensor2 416 320    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Bond Graph\EffortSensor.emx</LibraryPath>  <TimeStamp>2007-9-27 9:59:27</TimeStamp></Description>';    knot EffortSensor     ports      pseudohydraulic knot in p1 [1];      pseudohydraulic knot out p2 [1];      signal knot out effort [1];     restrictions      causality constraint not_equal p1 p2;    end;    icon bg ellipse     figures      ellipse 409.1 313.3 422.9 327.4 color 0 fill 16777215;      text 'e' 416.5 317.6 color 0;    end;    implementation eqequations	p2.e = p1.e;	p1.f = p2.f;	effort = p1.e;     implementation_end;   IntakeVVArea 328.1 200.1			specifications active 'Intake'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:54:56</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 fill 15132390;   text 'VVArea' 328 200 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvExh;		 	// Valve Seat diameter	real global betaExh;   	// valve seat angle	real global wExh;      	// valve seat width	real global DpExh;    		// Valve port diameter	real global DsExh; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wExh / (sin(betaExh)*cos(betaExh)))) then			aOpen = pi*(lift)*cos(betaExh)*(DvExh - 2*wExh + lift/2*sin(betaExh*2));		else 			if (lift <= (sqrt((DpExh^2 - DsExh^2)/(4*(DvExh - wExh)) - wExh^2) + wExh*tan(betaExh))) then				aOpen = pi*(DvExh - wExh)*sqrt((lift - wExh*tan(betaExh))^2 + wExh^2);			else				aOpen = 0.25*pi*(DpExh^2 - DsExh^2);			end;		end;				L_Dv = lift/DvExh;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;				specification 'Intake' description '<Information><Description><Version>4.5</Version><LibraryPath>Components\PoppetValveAreaCd.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2015-6-22 22:48:36</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description></Information>'; type Submodel  ports   signal in lift {m} ;   signal in pIn {Pa} ;   signal in pOut {Pa} ;   signal out aOpen {m2} ; "Open area"   signal out Cd; "Discharge coefficient"   signal out aEff {m2} ; "Effective area of nozzle" end; icon bg bottom  figures   rectangle 287.8 185.1 368.4 215.2 color 0 fill 15132390;   text 'VVArea' 328 200 color 0 16;  terminals   lift 304 176 fixed;   pIn 328 176 fixed;   pOut 352 176 fixed;   aOpen 304 224 fixed;   Cd 328 224 fixed;   aEff 352 224 fixed; end; implementation eq/* Poppet Valve Area Calculation	This calcuates the opening area, discharge coefficient and effective opening	area for poppet valve.		Input		lift : Valve lift [m]		pIn : Upstream pressure [Pa]		pOut : Downstream pressure [Pa]	Output		aOpen : Valve opening [m2]		Cd : Discharge coefficient		aEff : Effective valve opening [m2]			Version  | Created by     | Place      |  Changes	------------------------------------------------------	1.0      | Kevin K. Yum   | NTNU       | First model	*/constants	real CdCorrCoeffP[3] = [0.5329;-0.2047;0.04292];	real CdCorrCoeffQ[3] = [0.5359;-0.2962;0.06275];	// Discharge coeffcient correction factors	real CdCorrCoeffPr[3] = [-0.006345;0.09503;0.8117];	// Discharge coefficient correction factor		// The fit model was taken from the Sher, E. (1990). Scavenging 	// the two-stroke engine. Progress in Energy and Combustion Science, 	// 16(2), 95-124. parameters	real global DvIntake;		 	// Valve Seat diameter	real global betaIntake;   	// valve seat angle	real global wIntake;      	// valve seat width	real global DpIntake;    		// Valve port diameter	real global DsIntake; 			// Valve stem diametervariables	real L_Dv, pr;equations	if (lift > 0) then		if (lift < (wIntake / (sin(betaIntake)*cos(betaIntake)))) then			aOpen = pi*(lift)*cos(betaIntake)*(DvIntake - 2*wIntake + lift/2*sin(betaIntake*2));		else 			if (lift <= (sqrt((DpIntake^2 - DsIntake^2)/(4*(DvIntake - wIntake)) - wIntake^2) + wIntake*tan(betaIntake))) then				aOpen = pi*(DvIntake - wIntake)*sqrt((lift - wIntake*tan(betaIntake))^2 + wIntake^2);			else				aOpen = 0.25*pi*(DpIntake^2 - DsIntake^2);			end;		end;				L_Dv = lift/DvIntake;		Cd = ((L_Dv*CdCorrCoeffP[1] + CdCorrCoeffP[2])*L_Dv + CdCorrCoeffP[3])	            / (((L_Dv + CdCorrCoeffQ[1])*L_Dv + CdCorrCoeffQ[2])*L_Dv + 	            CdCorrCoeffQ[3]);		if (pIn > pOut) then			pr = pIn/pOut;		else			pr = pOut/pIn;		end;			Cd = Cd*((CdCorrCoeffPr[1]*pr + CdCorrCoeffPr[2])*pr + CdCorrCoeffPr[3]);		aEff = aOpen*Cd;	else		aOpen = 0;		Cd = 0;		aEff = 0;	end;		 implementation_end;specification_end;			end;   IntakeVVLift1 304 120			specifications active 'IntakeLiftVar'				specification 'Exhaust'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-11-2 23:44:24</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 763.9 96 836.1 128 fill 15132390;   text 'VVLift' 800 112 16;  terminals   lift 800 136 fixed;   CA 824 88 fixed;   CA_start_nom 776 88 fixed;   dCA_lift_nom 800 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox;	string global fnc_interp;	integer global ExhProfNoRow1;	integer global ExhProfNoRow2;	real global ExhVVProfUpX[ExhProfNoRow1];	real global ExhVVProfUpY[ExhProfNoRow1];	real global ExhVVProfDownX[ExhProfNoRow2];	real global ExhVVProfDownY[ExhProfNoRow2];	real global ExhLift_max;	integer global nStroke;	real global ExhCA_start_ref; //Reference start CA for start of valve lift	real global ExhdCA_lift_up;	 //Lift up time (should not be changed unless file is changed	real global ExhdCA_lift_down; //Lift down time (should not be changed unless file is changed	real global ExhdCA_lift_top_ref; //Reference duration for lift upvariables	real inarr1[2*ExhProfNoRow1+2];							//length should be 2 * no. of row of profile table + 2	real inarr2[2*ExhProfNoRow2+2];							//length should be 2 * no. of row of profile table + 2	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = ExhProfNoRow1;	inarr1[2:ExhProfNoRow1+1] = ExhVVProfUpX; 	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUpY;			inarr2[1] = ExhProfNoRow2;	inarr2[2:ExhProfNoRow2+1] = ExhVVProfDownX; 	inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDownY;			equations	CA_start = CA_start_nom*ExhCA_start_ref;	dCA_lift = dCA_lift_nom*ExhdCA_lift_top_ref;		dCA_total = ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= ExhdCA_lift_up then			inarr1[ExhProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= ExhdCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= ExhdCA_lift_up + dCA_lift + ExhdCA_lift_down then							CA_VV = phi - (CA_start + ExhdCA_lift_up + dCA_lift);							inarr2[ExhProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'ExhaustVarLift'description '<Information><Description><Version>4.5</Version><LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description><Attributes><GlobalRelations></GlobalRelations></Attributes></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 355.9 256 428.1 288 color 0 fill 15132390;   text 'VVLift' 392 272 color 0 16;  terminals   lift 392 296 fixed;   CA 416 248 fixed;   CA_start_nom 368 248 fixed;   dCA_lift_nom 392 248 fixed; end; implementation eqparameters	string dllToolbox = 'C:\Users\yum\Documents\GitHub\20SimToolBox\dll20SimToolVS10\Release\dll20SimToolVS10';	string global fnc_interp = 'interpolate';	integer global ExhProfNoRow1 = 30;	integer global ExhProfNoRow2 = 30;	real global ExhVVProfUp[ExhProfNoRow1] = [			0;			0.007;			0.021;			0.046;			0.07;			0.105;			0.161;			0.211;			0.267;			0.323;			0.372;			0.435;			0.491;			0.547;			0.604;			0.653;			0.702;			0.744;			0.782;			0.818;			0.853;			0.884;			0.909;			0.93;			0.951;			0.965;			0.979;			0.989;			0.996;			1];	real global ExhVVProfDown[ExhProfNoRow1] = [			1;			0.996;			0.993;			0.982;			0.972;			0.958;			0.937;			0.912;			0.884;			0.856;			0.821;			0.786;			0.744;			0.702;			0.656;			0.614;			0.565;			0.509;			0.442;			0.379;			0.319;			0.253;			0.196;			0.14;			0.095;			0.06;			0.032;			0.018;			0.006;			0];	real global ExhLift_max = 0.01425;	real global nStroke = 4;	real hidden global ExhCA_start_ref = 130; //Reference start CA for start of valve lift	real hidden global ExhdCA_lift_up = 123;	 //Lift up time (should not be changed unless file is changed	real hidden global ExhdCA_lift_down = 123; //Lift down time (should not be changed unless file is changed//	real hidden global IndCA_lift_top_ref = 0; //Reference duration for lift upvariables	real inarr1[ExhProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[ExhProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real CA_start_cyc;	real dCA_total_ref;	real phi;	integer i;	boolean reset;initialequations	CA_start_cyc = 720;	reset = true;	inarr1[1] = ExhProfNoRow1;	for i = 1 to ExhProfNoRow1 do		inarr1[i+1] = i / ExhProfNoRow1;	end;	inarr1[ExhProfNoRow1+2:ExhProfNoRow1*2+1] = ExhVVProfUp;			inarr2[1] = ExhProfNoRow2;	for i = 1 to ExhProfNoRow2 do		inarr2[i+1] = i / ExhProfNoRow2;	end;		inarr2[ExhProfNoRow2+2:ExhProfNoRow2*2+1] = ExhVVProfDown;		dCA_total_ref = ExhdCA_lift_up + ExhdCA_lift_down;		equations	CA_start = CA_start_nom*ExhCA_start_ref;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and reset == true then		reset = false;		CA_start_cyc = CA_start;		dCA_total = dCA_total_ref * max([1; dCA_lift_nom]);		dCA_lift = dCA_total - dCA_total_ref;		end;	if phi > CA_start_cyc then		if phi < CA_start_cyc + dCA_total then			CA_VV = (phi - CA_start_cyc)/ExhdCA_lift_up;			if CA_VV <= 1 then				inarr1[ExhProfNoRow1*2+2] = CA_VV;				lift = dll(dllToolbox, fnc_interp, inarr1);			else 					CA_VV = (phi - CA_start_cyc)/(ExhdCA_lift_up + dCA_lift);				if CA_VV <= 1 then					lift = 1;			  	else 						CA_VV = (phi - (CA_start_cyc + ExhdCA_lift_up + dCA_lift))/ExhdCA_lift_down;					inarr2[ExhProfNoRow2*2+2] = CA_VV;					lift = dll(dllToolbox, fnc_interp,inarr2);				end;			end;		else			lift = 0;		end;	else		lift = 0;			if reset == false then			reset = true;			CA_start_cyc = 720;		end;								end;				lift = ExhLift_max*lift; implementation_end;specification_end;				specification 'Intake'description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-10-20 15:16:35</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate>  <Configuration>   <struct>    <member>     <name>DocumentationMask</name>     <value>      <struct></struct>     </value>    </member>   </struct>  </Configuration> </Description></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 96 340.1 128 color 0 fill 15132390;   text 'VVLift' 304 112 color 0 16;  terminals   lift 304 136 fixed;   CA 328 88 fixed;   CA_start_nom 280 88 fixed;   dCA_lift_nom 304 88 fixed; end; implementation eqparameters//	real CA_start_nom = 1.1;//	real dCA_lift_nom = 1;	string global dllToolbox = 'dllTool20Sim.dll';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1;	integer global InProfNoRow2;	real global InVVProfUpX[InProfNoRow1]; 	real global InVVProfUpY[InProfNoRow1];	real global InVVProfDownX[InProfNoRow2];	real global InVVProfDownY[InProfNoRow2];	real global InLift_max = 1;	real global nstorke = 0;	real hidden global InCA_start_ref = 107; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 37.7;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 52; //Lift down time (should not be changed unless file is changed	real hidden global IndCA_lift_top_ref = 60; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real phi;initialequations	inarr1[1] = InProfNoRow1;	inarr1[2:InProfNoRow1+1] = InVVProfUpX; 	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUpY;			inarr2[1] = InProfNoRow2;	inarr2[2:InProfNoRow2+1] = InVVProfUpX; 	inarr2[InProfNoRow2+2:InProfNoRow2+1] = InVVProfUpY;			equations	CA_start = CA_start_nom*InCA_start_ref;	dCA_lift = dCA_lift_nom*IndCA_lift_top_ref;		dCA_total = IndCA_lift_up + dCA_lift + IndCA_lift_down;	phi = CA*180/pi mod (nstorke*180);	if phi > CA_start and phi < CA_start + dCA_total then		CA_VV = phi - CA_start;		if CA_VV <= IndCA_lift_up then			inarr1[InProfNoRow1*2+2] = CA_VV;			lift = dll(dllToolbox, fnc_interp, inarr1);		else 	if CA_VV <= IndCA_lift_up + dCA_lift then					lift = 1;			  	else 	if CA_VV <= IndCA_lift_up + dCA_lift + IndCA_lift_down then							CA_VV = phi - (CA_start + IndCA_lift_up + dCA_lift);							inarr2[InProfNoRow2*2+2] = CA_VV;							lift = dll(dllToolbox, fnc_interp,inarr2);					 	else 					 		lift = 0;							end;				end;		end;	else		lift = 0;		end;				lift = InLift_max*lift; implementation_end;specification_end;				specification 'IntakeLiftVar' description '<Information><Description><Version>4.6</Version><LibraryPath>Components\ValveLift.emx</LibraryPath><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues><TimeStamp>2016-4-1 23:07:16</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate><Configuration><struct><member><name>DocumentationMask</name><value><struct></struct></value></member></struct></Configuration></Description><Attributes><GlobalRelations></GlobalRelations></Attributes></Information>'; type ExhVVLift  ports   signal out lift;   signal in CA;   signal in CA_start_nom;   signal in dCA_lift_nom; end; icon bg bottom  figures   rectangle 267.9 104 340.1 136 color 0 fill 15132390;   text 'VVLift' 304 120 color 0 16;  terminals   lift 304 144 fixed;   CA 328 96 fixed;   CA_start_nom 280 96 fixed;   dCA_lift_nom 304 96 fixed; end; implementation eqparameters	string dllToolbox = 'C:\Users\yum\Documents\GitHub\20SimToolBox\dll20SimToolVS10\Release\dll20SimToolVS10';	string global fnc_interp = 'interpolate';	integer global InProfNoRow1 = 30;	integer global InProfNoRow2 = 30;	real global InVVProfUp[InProfNoRow1] = [0;0.007;0.021;0.046;0.070;0.105;0.161;0.211;0.267;0.323;														  0.372;0.435;0.491;0.547;0.604;0.653;0.702;0.744;0.782;0.818;														  0.853;0.884;0.909;0.930;0.951;0.965;0.979;0.989;0.996;1];	real global InVVProfDown[InProfNoRow1] = [1;0.996;0.993;0.982;0.972;0.958;0.937;0.912;0.884;0.856;														0.821;0.786;0.744;0.702;0.656;0.614;0.565;0.509;0.442;0.379;														0.319;0.253;0.196;0.140;0.095;0.060;0.032;0.018;0.006;0];	real global InLift_max = 0.014;	real global nStroke = 4;	real hidden global InCA_start_ref = 343; //Reference start CA for start of valve lift	real hidden global IndCA_lift_up = 121;	 //Lift up time (should not be changed unless file is changed	real hidden global IndCA_lift_down = 121; //Lift down time (should not be changed unless file is changed//	real hidden global IndCA_lift_top_ref = 0; //Reference duration for lift upvariables	real inarr1[InProfNoRow1*2+2];							//length should be 2 * no. of row of profile table + 1	real inarr2[InProfNoRow2*2+2];							//length should be 2 * no. of row of profile table + 1	real CA_start, dCA_lift, dCA_total, CA_VV;	real CA_start_cyc;	real dCA_total_ref;	real phi;	integer i;	boolean reset;initialequations	CA_start_cyc = 720;	reset = true;	inarr1[1] = InProfNoRow1;	for i = 1 to InProfNoRow1 do		inarr1[i+1] = i / InProfNoRow1;	end;	inarr1[InProfNoRow1+2:InProfNoRow1*2+1] = InVVProfUp;			inarr2[1] = InProfNoRow2;	for i = 1 to InProfNoRow2 do		inarr2[i+1] = i / InProfNoRow2;	end;		inarr2[InProfNoRow2+2:InProfNoRow2*2+1] = InVVProfDown;		dCA_total_ref = IndCA_lift_up + IndCA_lift_down;		equations	CA_start = CA_start_nom*InCA_start_ref;	phi = CA*180/pi mod (nStroke*180);	if phi > CA_start and reset == true then		reset = false;		CA_start_cyc = CA_start;		dCA_total = dCA_total_ref * max([1; dCA_lift_nom]);		dCA_lift = dCA_total - dCA_total_ref;		end;	if phi > CA_start_cyc then		if phi < CA_start_cyc + dCA_total then			CA_VV = (phi - CA_start_cyc)/IndCA_lift_up;			if CA_VV <= 1 then				inarr1[InProfNoRow1*2+2] = CA_VV;				lift = dll(dllToolbox, fnc_interp, inarr1);			else 					CA_VV = (phi - CA_start_cyc)/(IndCA_lift_up + dCA_lift);				if CA_VV <= 1 then					lift = 1;			  	else 						CA_VV = (phi - (CA_start_cyc + IndCA_lift_up + dCA_lift))/IndCA_lift_down;					inarr2[InProfNoRow2*2+2] = CA_VV;					lift = dll(dllToolbox, fnc_interp,inarr2);				end;			end;		else			lift = 0;		end;	else		lift = 0;			if reset == false then			reset = true;			CA_start_cyc = 720;		end;								end;				lift = InLift_max*lift; implementation_end;specification_end;			end;   MultiplyDivide1 352 248    description '<Description><Version>4.0</Version><Version>4.0</Version><IsMainModel>1</IsMainModel><KeepParameterValues>False</KeepParameterValues>   <LibraryPath>Signal\Block Diagram\MultiplyDivide.emx</LibraryPath>  <TimeStamp>2007-9-27 10:14:59</TimeStamp></Description>';    knot MultiplyDivide     ports      signal knot duplicatable in multiply [1];      signal knot duplicatable in divide [1];      signal knot out output [1];    end;    icon bg ellipse     figures      ellipse 344 240 360 256 color 0 fill 16777215;    end;    implementation eqequations	output = mul (collect (multiply)) ./ mul (collect (divide));     implementation_end;   plug dVONom 304 56;   plug pTFOut 504 336;   plug aOpenEff 520.1 280;   plug Cd 328 264;   plug areaMultiplier 448 32;   plug VONom 280.1 32;   plug CA 327.8 69.9;   plug pTFIn 200 336;   PowerDemux 240 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   output1 128 72 fixed;   input 128 80 fixed;   output2 128 88 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power in input;   power out output;  restrictions   causality constraint not_equal output input; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = output.e;	input.f = output.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power in input [2,1];   power out output2;  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   output1 128 64 fixed;   input 128 72 fixed;   output2 128 80 fixed; end; implementation eqequations	input.e = [output1.e; output2.e];	input.f = [output1.f; output2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power in input [3,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input; end; icon bg bottom  figures   line 240 312 240 360 color 0 width 2;   rectangle 235 320 243 352 color -1;   text '3' 244 346 color 8421504 8;  terminals   output1 240 320 fixed;   output2 240 336 fixed;   output3 240 352 fixed;   input 232 336 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e];	input.f = [output1.f; output2.f; output3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power in input [4,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 80 fixed;   output4 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e];	input.f = [output1.f; output2.f; output3.f; output4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power in input [5,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   output1 128 56 fixed;   output2 128 64 fixed;   output3 128 72 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power in input [6,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 80 fixed;   output5 128 88 fixed;   output6 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power in input [7,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   output1 128 48 fixed;   output2 128 56 fixed;   output3 128 64 fixed;   output4 128 72 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power in input [8,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 80 fixed;   output6 128 88 fixed;   output7 128 96 fixed;   output8 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e];	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerDemux  ports   power out output1;   power out output2;   power out output3;   power out output4;   power out output5;   power out output6;   power out output7;   power out output8;   power out output9;   power in input [9,1];  restrictions   causality constraint not_equal output1 input;   causality constraint not_equal output2 input;   causality constraint not_equal output3 input;   causality constraint not_equal output4 input;   causality constraint not_equal output5 input;   causality constraint not_equal output6 input;   causality constraint not_equal output7 input;   causality constraint not_equal output8 input;   causality constraint not_equal output9 input; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   output1 128 40 fixed;   output2 128 48 fixed;   output3 128 56 fixed;   output4 128 64 fixed;   output5 128 72 fixed;   output6 128 80 fixed;   output7 128 88 fixed;   output8 128 96 fixed;   output9 128 104 fixed;   input 128 72 fixed; end; implementation eqequations	input.e = [output1.e; output2.e; output3.e; output4.e; output5.e; output6.e; output7.e; output8.e; output9.e];implementation_end;	input.f = [output1.f; output2.f; output3.f; output4.f; output5.f; output6.f; output7.f; output8.f; output9.f];specification_end;			end;   PowerMux 448 336			specifications active 'inputs_3'				specification 'default'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerDemux.emx</LibraryPath>  <TimeStamp>2011-10-5 22:44:58</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 64 128 96 width 2;   rectangle 124 64 132 96 color -1;   text '2' 133 91 color 8421504 8;  terminals   input1 128 72 fixed;   output 128 80 fixed;   input2 128 88 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_1'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input;   power out output;  restrictions   causality constraint not_equal input output; end; icon bg bottom  figures   line 128 64 128 80 width 2;   rectangle 124 64 132 80 color -1;   text '1' 133 82 color 8421504 8;  terminals   input 128 72 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = input.e;	output.f = input.f;implementation_end;specification_end;				specification 'inputs_2'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power out output [2,1];   power in input2;  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output; end; icon bg bottom  figures   line 128 56 128 88 width 2;   rectangle 124 56 132 88 color -1;   text '2' 133 83 color 8421504 8;  terminals   input1 128 64 fixed;   output 128 72 fixed;   input2 128 80 fixed; end; implementation eqequations	output.e = [input1.e; input2.e];	output.f = [input1.f; input2.f];implementation_end;specification_end;				specification 'inputs_3' description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power out output [3,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output; end; icon bg bottom  figures   line 448 312 448 360 color 0 width 2;   rectangle 443 312 451 344 color -1;   text '3' 452 338 color 8421504 8;  terminals   input1 448 320 fixed;   input2 448 336 fixed;   input3 448 352 fixed;   output 456 336 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e];	output.f = [input1.f; input2.f; input3.f];implementation_end;specification_end;				specification 'inputs_4'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power out output [4,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '4' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 80 fixed;   input4 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e];	output.f = [input1.f; input2.f; input3.f; input4.f];implementation_end;specification_end;				specification 'inputs_5'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power out output [5,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output; end; icon bg bottom  figures   line 128 48 128 96 width 2;   rectangle 124 48 132 96 color -1;   text '5' 133 83 color 8421504 8;  terminals   input1 128 56 fixed;   input2 128 64 fixed;   input3 128 72 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f];implementation_end;specification_end;				specification 'inputs_6'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power out output [6,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '6' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 80 fixed;   input5 128 88 fixed;   input6 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f];implementation_end;specification_end;				specification 'inputs_7'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power out output [7,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output; end; icon bg bottom  figures   line 128 40 128 104 width 2;   rectangle 124 40 132 104 color -1;   text '7' 133 83 color 8421504 8;  terminals   input1 128 48 fixed;   input2 128 56 fixed;   input3 128 64 fixed;   input4 128 72 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f];implementation_end;specification_end;				specification 'inputs_8'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power out output [8,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   rectangle 124 32 132 112 color -1;   text '8' 133 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 80 fixed;   input6 128 88 fixed;   input7 128 96 fixed;   input8 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e];	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f];implementation_end;specification_end;				specification 'inputs_9'description '<Description>   <Version>4.1</Version>  <LibraryPath>Bond Graph\PowerMux.emx</LibraryPath>  <TimeStamp>2011-3-4 15:12:50</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues> <AllowLibraryUpdate>True</AllowLibraryUpdate></Description>'; type PowerMux  ports   power in input1;   power in input2;   power in input3;   power in input4;   power in input5;   power in input6;   power in input7;   power in input8;   power in input9;   power out output [9,1];  restrictions   causality constraint not_equal input1 output;   causality constraint not_equal input2 output;   causality constraint not_equal input3 output;   causality constraint not_equal input4 output;   causality constraint not_equal input5 output;   causality constraint not_equal input6 output;   causality constraint not_equal input7 output;   causality constraint not_equal input8 output;   causality constraint not_equal input9 output; end; icon bg bottom  figures   line 128 32 128 112 width 2;   text '9' 132 83 color 8421504 8;  terminals   input1 128 40 fixed;   input2 128 48 fixed;   input3 128 56 fixed;   input4 128 64 fixed;   input5 128 72 fixed;   input6 128 80 fixed;   input7 128 88 fixed;   input8 128 96 fixed;   input9 128 104 fixed;   output 128 72 fixed; end; implementation eqequations	output.e = [input1.e; input2.e; input3.e; input4.e; input5.e; input6.e; input7.e; input8.e; input9.e];implementation_end;	output.f = [input1.f; input2.f; input3.f; input4.f; input5.f; input6.f; input7.f; input8.f; input9.f];specification_end;			end;   Splitter1 352 280    description '<Description><Version>4.0</Version>   <LibraryPath>Signal\Block Diagram\Splitter.emx</LibraryPath>  <TimeStamp>2008-01-17 11:28:29</TimeStamp><IsMainModel>1</IsMainModel> <KeepParameterValues>False</KeepParameterValues></Description>';    knot Splitter     ports      signal knot duplicatable out output [1];      signal knot in input [1];    end;    icon bg ellipse     figures      ellipse 348.8 276.8 355.2 283.2 color -1 fill 0;      ellipse 347.7 275.7 356.3 284.3 color -1;     terminals      input 352 280 fixed;    end;    implementation eqequations    collect (output) = input;implementation_end;   Submodel2 352 351    description '<Information> <Description>    <Version>4.5</Version>  <LibraryPath>FlowRestriction\IdealNozzleCompGas.emx</LibraryPath><IsMainModel>1</IsMainModel>  <KeepParameterValues>False</KeepParameterValues>    <TimeStamp>2015-6-22 16:30:00</TimeStamp><AllowLibraryUpdate>False</AllowLibraryUpdate> </Description></Information>';    type Submodel     ports      signal in Aeff; "Effective area of nozzle (m2)"      pseudohydraulic in ppIn;      pseudothermalh in pTIn;      power in pFIn;      pseudohydraulic out ppOut;      pseudothermalh out pTOut;      power out pFOut;     restrictions      causality fixed in ppOut;      causality fixed in pFOut;      causality fixed in ppIn;      causality fixed in pTIn;      causality fixed in pFIn;    end;    icon bg bottom     figures      text 'R' 352 336 color 0 53 bold;      text 'IdealNozzle
CompFlow' 352 376 color 0 16;     terminals      Aeff 352 304 fixed;      ppIn 320 320 fixed;      pTIn 320 336 fixed;      pFIn 320 352 fixed;      ppOut 384 320 fixed;      pTOut 384 336 fixed;      pFOut 384 352 fixed;    end;    implementation eq/* Ideal Nozzle ModelUses ideal nozzle equation for compressible flows assuming isentropic process. Flow restriction field. No states.Input   - Effective area of nozzle (Aeff)  - p,T,F in  - p,T,F outOutput  - dm, dE, dmb in  - dm, dE, dmb out*/parameters 	real global fs;	string global dll_ICE;	string global dll_fcn_idealNozzle;variables	real pIn, TIn, FIn, pOut;	real dm, dE, dmb;	real aa, d, pr;	real	inArrFlow[4];	real outArrFlow[3];equations  // start typing here 	aa = ppIn.e / ppOut.e;	if (aa > 1) then		pIn	= ppIn.e; TIn = pTIn.e; FIn = pFIn.e; d	= 1; 	pr = aa;		pOut = ppOut.e;	else		pIn	= ppOut.e; TIn=pTOut.e; FIn= pFOut.e;	d	= -1; pr	= 1.0/aa;		pOut = ppIn.e;	end;		// Calculate thermodynamic properties from (T,P,x)	inArrFlow = [1,Aeff,pIn,TIn,FIn,pOut,fs];	outArrFlow = dll(dll_ICE,dll_fcn_idealNozzle, inArrFlow);			dm = outArrFlow[1]*d;	dE = outArrFlow[2]*d;		dmb = outArrFlow[3]*d;	ppIn.dm = dm;	ppOut.dm  = dm;	pTIn.dH = dE;	pTOut.dH = dE;	pFIn.f = dmb;	pFOut.f = dmb;implementation_end;  end;  connections   areaMultiplier -> MultiplyDivide1\multiply 448 248;   CA -> IntakeVVLift1\CA;   dVONom -> IntakeVVLift1\dCA_lift_nom;   EffortSensor1\effort -> IntakeVVArea\pIn 272 160 328 160;   EffortSensor1\p2 => Submodel2\ppIn;   EffortSensor2\effort -> IntakeVVArea\pOut 416 160 352 160;   EffortSensor2\p2 => PowerMux\input1;   IntakeVVArea\aEff -> MultiplyDivide1\multiply;   IntakeVVArea\Cd -> Cd;   IntakeVVLift1\lift -> IntakeVVArea\lift;   MultiplyDivide1\output -> Splitter1\input;   PowerDemux\output1 => EffortSensor1\p1;   PowerDemux\output2 => Submodel2\pTIn;   PowerDemux\output3 => Submodel2\pFIn;   PowerMux\output => pTFOut;   pTFIn => PowerDemux\input;   Splitter1\output -> aOpenEff;   Splitter1\output -> Submodel2\Aeff;   Submodel2\pFOut => PowerMux\input3;   Submodel2\ppOut => EffortSensor2\p1;   Submodel2\pTOut => PowerMux\input2;   VONom -> IntakeVVLift1\CA_start_nom;  end;  figures   text 'Global parameters
      real global lift_max;     // Maximum lift of the vavle
      real global nstorke;     // number of stroke
      real hidden global CA_start_ref;        //Reference start CA for start of valve lift
      real hidden global dCA_lift_up;	//Lift up time (should not be changed unless file is changed
      real hidden global dCA_lift_down;     //Lift down time (should not be changed unless file is changed
      real hidden global dCA_lift_top_ref;   //Reference duration for lift up
      real global Dv;		 	// Valve Seat diameter
      real global beta;   	// valve seat angle
      real global w;      	// valve seat width
      real global Dp;    		// Valve port diameter
      real global Ds; 			// Valve stem diameter
      
' 288 504 color 0 16; implementation_end;specification_end;end;]]>
  </Sidops>
</Model>
</Document>
